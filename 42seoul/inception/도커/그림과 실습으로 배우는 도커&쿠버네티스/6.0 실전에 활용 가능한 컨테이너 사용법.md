---
날짜: '"2023-11-08"'
넘버: 
태그: 프로그래밍/도커
출처: 그림과 실습으로 배우는 도커 & 쿠버네티스
aliases:
---
### 날짜  2023-11-08 16:27

### 태그: #프로그래밍/도커 

>[!메모]
>

### 원문
---
# 6.2 컨테이너와 호스트 간에 파일 복사하기
## 파일 복사
```bash
# 호스트 -> 컨테이너
docker cp 호스트_경로 컨테이너_이름:컨테이너_경로
# 컨테이너 -> 호스트
docker cp 컨테이너_이름:컨테이너_경로 호스트_경로 
```
# 6.3 볼륨 마운트
## 볼륨과 마운트
- 볼륨
	- 스토리지의 한 영역을 분할한 것.
- **데이터 퍼시스턴시 data persistency**
	- 컨테이너는 생성 및 폐기가 매우 빈번하기 때문에 매번 데이터를 옮기는 대신 컨테이너 외부에 둔 데이터에 접근해 사용하는 것이 일반적이다
## 스토리지 마운트의 종류
### 볼륨 마운트
- 도커 엔진이 관리하는 영역 내에 만들어진 볼륨으로 컨테이너에 디스크 형태로 마운트한다.
- 이름만으로 관리가 가능하기 때문에 다루기 쉽다.
- 하지만 볼륨에 비해 직접 조작하기 어렵다.
- **임시 목적 또는 자주 쓰지는 않지만 지우면 안 되는 파일을 저장**하는 목적으로 사용한다.
### 바인드 마운트
- 도커가 설치된 컴퓨터의 문서 폴더 또는 바탕화면 폴더 등 도커 엔진에서 관리하지 않는 영역의 기존 디렉터리를 컨테이너에 마운트 하는 방식이다.
- 디렉터리가 아닌 파일 단위로도 마운트가 가능하다.
- **폴더 속에 파일을 직접 두거나 열어볼 수 있기 때문에 자주 사용하는 파일을 두는 데 사용**한다.
### 두 마운트 방식의 차이점
- 주요 차이점
	- 간단한지 복잡한지
	- 호스트 컴퓨터에서 파일을 다룰 필요가 있는지
	- 환경의 의존성을 배제해야 하는지
- 볼륨 마운트
	- 도커 엔진의 관리 하에 있으므로 사용자가 파일 위치를 신경 쓰지 않아도 된다.
		- 바탕화면에 두었다가 실수로 지우는 일도 일어나지 않음.
	- 운영체제에 따라 명령어가 달라지는 등의 의존성 문제도 일어나지 않는다.
	- 볼륨마운트는 익숙해지면 쉽게 사용 가능하다.
		- **도커 제작사에서도 볼륨 마운트 사용을 권장함**
	- 단점
		- 도커 컨테이너를 경유하지 않고 직접 볼륨에 접근할 방법이 없음.
		- 백업또한 복잡한 절차가 필요함.
- 바인드 마운트
	- 도커가 관리하지 않는 영역 어디에도 파일을 둘 수 있다.
	- 기존과 동일한 방식으로 파일을 사용할 수 있다.
		- 도커엔진과 무관하게 파일을 다룰 수 있다.
		- 다른 소프트웨어를 사용하여 쉽게 편집할 수 있음.
		- 워드프레스 처럼 파일을 자주 편집해야 하는 경우에는 바인드 마운트를 사용하곤 한다.
- 결론
	- 파일을 직접 편집해야 할 일이 많다면 **바인드 마운트**
	- 그렇지 않다면 **볼륨 마운트**

|항목|볼륨 마운트| 바인드 마운트|
|--|--|--|
|스토리지 영역| 볼륨 | 디렉터리 또는 파일|
|물리적 위치 | 도커 엔진의 관리 영역 | 어디든지 가능 |
|마운트 절차 | 볼륨을 생성한 후 마운트 | 기존 파일 또는 폴더를 마운트 | 
|내용 편집 | 도커 컨테이너로 | 일반적 파일과 같음 | 
|백업 | 절차가 복잡 | 일반적 파일과 같음|
## 스토리지 영역을 마운트하는 커맨드
- 스토리지 마운트는 run 커맨드의 옵션 형태로 지정한다.
- 마운트 원본이 되는 스토리지 영역의 위치와 마운트 대상이 되는 위치를 경로 형태로 지정한다.
	- 마운트 대상이 되는 컨테이너의 위치는 소프트웨어가 콘텐츠를 저장한느 경로가 되는 경우가 많다.
		- 아파치: `/usr/local/apache2/htdocs`
		- MySQL: `/var/lib/mysql`
		- 데이터가 위치하는 경로는 도커 이미지의 참조 문서를 참고하라.
### 스토리지를 마운트하는 절차
- 마운트될 스토리지를 먼저 생성해야 한다.
- 볼륨 마운트의 경우에는 마운트와 동시에 볼륨을 만들 수 있으나, 권장되지 않음.
### 스토리지 영역을 만드는 방법
- 마운트 할 대상을 미리 만든다.
```sh
# 볼륨 생성(볼륨 마운트)
docker volume create 볼륨_이름
# 볼륨 삭제
docker volume rm 볼륨_이름
```
### 스토리지를 마운트하는 커맨드
- `-v`옵션 뒤에 '스토리지 실제 경로' 또는 '볼륨 이름', '컨테이너 마운트 경로' 순으로 기재한다.
- 바인드 마운트는 볼륨을 마운트하지 않지만 `-v`를 사용한다.
```bash
# 바인드 마운트 커맨드
docker run ... -v 스토리지_실제_경로:컨테이너_마운트_경로 ...
# 볼륨 마운트 커맨드
docker run ... -v 볼륨_이름:컨테이너_마운트_경로 ...
```
## 바인드 마운트해보기
- 컨테이너 생성할 때 옵션으로 이 폴더를 마운트한다.
- 폴더 속의 파일을 수정해보면 마운트가 잘 되었는지 확인할 수 있음.
```bash
docker run --name apa000ex20 -d -p 8090:80 \
	-v ~/conTemp:/usr/local/apache2/htdocs httpd
```
## 볼륨 마운트해보기
```bash
docker run --name apa000vol1 -d -p 8090:80 \
	-v apa000vol:/usr/local/apache2/htdocs httpd
```
# 6.4 컨테이너로 이미지 만들기
## 컨테이너로 이미지 만드는 방법
- 나만의 이미지를 만들어서 똑같은 구성의 컨테이너를 대량으로 만들 수도 있고, 다른 컴퓨터 또는 서버에 이동할 수도 있다.
### commit하여 컨테이너를 이미지로 변환
```bash
docker commit 컨테이너_이름 새로운_이름
```
### Dockerfile 스크립트로 이미지 만들기
- Dockerfile 스크립트를 작성하여 스크립트를 빌드해서 이미지를 만드는 방법.
```bash
docker build -t 생성할_이미지_이름 재료_폴더_경로
```
- [[2. Dockerfile |docker file 레퍼런스 정리]]




---
### 생각(파생된 질문/생각)

### 출처

### 연결 문서 (연결 이유)
