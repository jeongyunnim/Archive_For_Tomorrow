---
날짜: 2025-02-19
넘버: 
태그: 프로그래밍/임베디드
출처: LIG Nex1 The SSEN Embedded SW School
강사: 홍영기(guileschool@gmail.com)
aliases:
---
### 날짜:  2025-02-19 08:54

### 태그: #프로그래밍/임베디드

>[!메모]
> 

### 원문
---
# 8.0 임베디드 시스템 기본
### 들어가기 전에
- 지금 이 시간 부터는 C언어를 전면에 내세워야 한다.
	- 무조건 C언어, 닥치고 C언어
	- 임베디드 소프트웨어는 C언어로 시작해서 C언어로 끝난다.
- 이번 주 금요일 프로세서 구조 및 디바이스 프로그래밍
	- 8일 동안 진행
	- C언어 프로젝트를 할 것이다. 아침부터 저녁까지 문제, 어떤 기능을 하는 프로그램을 만드시오.
		- 평가 + 피드백
- 15년 경력의 강사
	- 원동력: 이 일을 사랑했기 때문에
	- 강사 이전: 12년 경력 개발자
	- 개발은 왜 그만뒀는가?: 어느 순간 재미가 없었다.
	- 강의가 적성이 맞았다.
### 교육 목표
- 임베디드 시스템이 무엇인가?
## 임베디드 시스템 개론
### 임베디드 시스템 정의
- **특정한 목적**을 수행하기 위해 디자인된 컴퓨터 시스템
	- 자동차, 가전제품, 디지털 카메라, ATM, 스마트폰, 드론, 로켓 등
- PC는 임베디드 시스템이라고 하지 않는다.
	- 범용으로 사용하기 때문
### 임베디드 시스템의 특징
- 특정 목적에 최적화
	- 특정 기능을 수행하는 것에 중점
	- **필요한, 최적화된** 하드웨어와 소프트웨어만 가지고 있다.
	- 하드웨어와 소프트웨어가 결합된 시스템
- 자원 제한
	- 제한된 메모리, 저장 공간, 컴퓨팅 파워 등을 가지고 있다.
	- 시스템 최적화가 중요하다.
- 실시간 작업
	- 모든 임베디드 실시간 시스템이다.
	- 실시간: 주어진 시간 내에 특정 작업을 완료해야 한다는 것을 의미한다.
- 내장형
	- 제품 내부에 내장되어있다.
### 임베디드 시스템의 종류

### 임베디드 시스템의 구성
- 하드웨어 + 소프트웨어(+ RTOS)
### 임베디드 시스템 하드웨어
- CPU
	- 모든 계산과 제어 작업을 담당한다.
- 메모리
	- 시스템이 실행되는 동안 **데이터**와 **명령어**를 저장하는 공간.
	- CPU가 작업을 하기 위한 값을 저장하는 공간
	- 데이터를 저장하는 메모리와 명령어를 저장하는 메모리
	- RAM: 임시적으로 저장 -> 전원이 들어와있는 동안만 동작
	- ROM: 전원을 끈 후에도 데이터를 보존한다.
		- 시스템의 부팅 코드나 필수적인 설정 값이 저장된다.
- 입출력 장치
	- 외부 세계와의 상호작용
	- 센서(모션, 온도, 조도 등), 스위치, 디스플레이, 통신 포트
- 기타 하드웨어 구성 요소
	- PAL, PLD, 외부 메모리, NIC 등

### 임베디드 시스템 소프트웨어
- 특화된 기능을 가진 제품을 위해 맞춤형 코드를 작성하는 과정
- 개발 과정
	- 시스템 요구 사항 정의
	- 적절한 하드웨어, 소프트웨어 선택
	- 시스템의 세부 기능을 위한 코드 작성
	- 테스팅과 검증
	- 실제 제품에 적용
- 장치의 특성에 따라 RTOS를 사용하는 경우가 있다.
### 임베디드 시스템 개발 환경
- 호스트 / 타겟 -> 개발 PC -> 보드
- 상호 작용의 수단
	- 물리적 연결
- 3가지의 전송 방법 
	- [[ICE]] 또는 [[JTAG]] 케이블
		- JTAG: 프로그램이 실행되는 타겟보드를 개발 PC에서 디버깅을 해볼 수 있도록 한다.
	- Serial 케이블
		- 프로그램 작성 시, 타겟 시스템에서 실행할 것이기 때문에 컴파일된 프로그램을 보낸다.
		- PC에서 연결해서 타겟 시스템의 출력을 연결된 시리얼 케이블 포트로 연결한다.
		- 속도가 느리다.
	- Ethrernet 케이블
		- 파일이 클 때는 serial 대신 Ethernet 케이블을 사용한다.
![[Excalidraw/LIG Nex1 임베디드.md#^group=GGQdeUTDWfNgJOyvxsoxU]]
### 임베디드 시스템 개발 환경
- 하드웨어
- 개발도구
- 소프트웨어
- 테스트 및 디버깅
### 임베디드 시스템 운영체제
- 실시간 운영체제 vs 리눅스 운영체제
	- 이때 사용되는 리눅스는 임베디드 리눅스라고 한다.
	- 전반부 RTOS
	- 후반부 임베디드 리눅스
- **임베디드 소프트웨어의 3가지 개발 방법**
	- 펌웨어 개발(베어 메탈 프로그래밍)
		- 제일 쉽다. + 고인물이 많다.
	- RTOS
	- 임베디드 리눅스
		- 악마스럽다.
### 실시간 임베디드 시스템
- 리얼타임 시스템
	- 정해진 시간 내에 임무를 수행하는 시스템
- **소프트 리얼타임 시스템**
	- 가능한 한 빠르게 임무를 수행하지만, 반드시 정해진 시간 내에 수행할 필요는 없다.
	- timeout인 경우에도 계속 수행
	- 동영상 플레이어, 커피 자판기, 전화기 등 
- **하드 리얼타임 시스템**
	- 어떤 사건이 발생했을 때 정확히 동작해야 한다. + 반드시 정해진 시간 내에 임무를 마쳐야 한다.
	- timeout인 경우 failure -> 잘못되면 큰일나는 경우
	- 인공위성, 미사일 제어, 원자력 발전소
### 실시간 운영체제 RTOS
- 특정 작업을 정해진 시간 안에 정확하게 처리할 수 있도록 설계된 운영체제
- 제한된 시간 안에 반응하거나 작업을 완료해야 하는 실시간 응용프로그램에 사용된다.
- GPOS: General Purpos OS
	- windows / linux
- RTOS는 어렵다..
	- 디버깅을 할 수 있어야 한다.
	- 까다로운 문제에 봉착할 확률이 높다.
- 원래의 목적은 실시간을 위해 만든 것이 아니다.
	- 임베디드 안에서도 OS가 있었으면 좋겠다는 생각으로 개발되었다.
	- 하드 리얼타임에서 필요하기 때문에 사용하는 것이 아니다.
#### 결정적인 타이밍 Deterministic timing
- 작업이 완료될 때까지 걸리는 시간을 예측할 수 있어야 한다.
	- N초 안에 완료되어야 한다는 기준이 있어야 한다.
	- 예상치 못한 동작을 하거나 성능이 안나올 수 있다. -> 개발자 탓
#### 멀티태스킹 Multitasking
- 여러 작업이나 프로세스를 동시에 실행할 수 있어야 한다.
	- 각종 연산, 출력 등의 동작을 시분할 방식을 통해 동시에 수행한다.
![[Excalidraw/LIG Nex1 임베디드.md#^group=wLkOkRcVGphNXe8YD7UQA]]
#### 우선순위 기발 스케줄링 Priority-based scheduling
- 작업에 우선순위를 부여하여, 가장 높은 우선순위를 가진 작업부터 처리하는 스케줄링
#### 기타 특징
- 최소한의 지연시간
- 메모리관리
- 등
### RTOS 종류
- Wind River(VxWorks)
	- 방산에서 가장 많이 사용한다.
	- 가장 탁월한 성능을 보인다.
		- NASA의 프로젝트에서 사용하는 OS
		- 실시간성이 중요하기 때문에
- QNX
	- 자동차 쪽에서 많이 사용한다.
- FreeRTOS
	- 무료
	- 얘를 다룰 줄 알면 VxWorks도 다룰 수 있다.
### 임베디드 시스템의 전망
- 임베디드 시스템은 기술 혁신의 중심에 위치한다.
	- 기술을 배우고나면 나중에 창업이 가능하다.
- 인공지능과 머신러닝의 활용도 증가
- IoT와 연결성
- 에너지 효율성
- 보안
- 5G와 발전하는 통신 기술
## 임베디드 시스템 설계
### 임베디드 시스템 제작 과정
- 공학적 절차를 따르는 복잡한 과정이다.
- 요구사항 정의
	- 라디오 기능, 다국어 지원 등 요구사항 수집
	- 제약 사항 정의
	- 필요한 기능과 성능 요구사항 명세
- 설계
	- 적절한 하드웨어와 소프트웨어 구성요소
	- 시스템 전반적인 구조를 설계
	- 시스템 주요 구성 요소, 인터페이스 등의 설계를 수행한다.
- 구현
- 테스팅
- 디버깅
- 최적화
	- 시스템 성능을 향상시키기 위해 하드웨어와 소프트웨어를 최적화한다.
	- 안 쓰는 기능의 클럭을 차단해버리면 전력 소모를 안 먹는다. 소비 전력을 확 줄일 수 있다.
- 유지보수
### 임베디드 소프트웨어 개발 환경
- 하드웨어
	- 특정한 하드웨어 위에서 동작하기 때문에 해당 하드웨어에 대한 깊은 이해가 필요하다.
	- 많이 알고 있을 수록 유리하다.
- 임베디드 운영체제
- 프로그래밍 언어
	- C/C++/Assembly와 같은 저수준 언어로 작성
	- 하드웨어에 직접 접근하고 자원을 효과적으로 관리하는 데 유리하다.
- 크로스 컴파일러
	- 임베디드 시스템은 PC와 다른 아키텍처를 사용하기 때문에, 소스코드를 타겟 하드웨어에서 실행 가능한 바이너리 형태로 변환하기 위한 컴파일러가 필요하다.
### LED 실습
- STM32F429I-DISC1
	- ST사에서 만든 칩을 사용하고 있다.
	- DISC = discovery
- 실습 환경
	- v1.12.0 - 로그인 필요하지 않음
	- ---- 로그인 필요
	- v1.13.0
	- ...
	- v1.17.0은 똥이다. 버그 천지.
- ARM
	- 비메모리 반도체(CPU) 회사
	- 설계 기술을 가지고 있다. - 영국
	- 2005년도 CORTEX-A, R, M을 release
	- 이 라이센스를 받아서 많은 반도체 회사들이 제조를 시작했다.
		- TI, ST, SAMSUNG, OKI...
- ST사 CORTEX-M을 내장한 프로세서: STM32
	- eg. STMF429ZI-DISC1
- HAL
	- 라이브러리는 보통 컴파일된 바이너리가 archive로 제공된다.
	- HAL library는 소스코드로 제공된다.
### 임베디드 소프트웨어 개발 환경
- 디버깅 도구
	- JTAG 디버거 aka ICE
	- 오실로스코프
	- 로직 분석기
- 버전 관리 시스템
	- GIT, SVN
- 자동화 도구
	- make, CMake

### 임베디드 소프트웨어 실행 파일 생성 과정
- IDE 추천
	- VSCODE
	- SUBLIME-TEXT
	- VI(VIM)
- 컴파일이 무엇인가?
	- 실행파일이 만들어지기 까지 일련의 과정
- OBJ 파일 -> 실행할 수 있는가?
	- startup code가 없기 때문에 실행이 불가능하다.
	- 컴파일러는 start.o를 가지고 있다.
	- [ ] 언제 start.s를 컴파일 하는가?
![[Excalidraw/LIG Nex1 임베디드.md#^group=WyxQpUnmvWYVEYBUCEaC9]]
### [[JTAG]] 인터페이스
- 디버그용 개발 장비
- 핀을 통해 신호가 들어오거나 나간다.
	- 0 -> LOW
	- 1 -> HIGH
- 외부에서 신호가 0인지 1인지를 알 수 있게 된다.
	- 핀을 통해 들어온 값은 연결된 레지스터에 저장이 된다.
	- 출력으로 내보내는 값 또한 연결된 레지스터에 저장된다. 
	- JTAG은 레지스터의 값을 읽어서 출력한다.
- STM -> 디버깅 시 trace를 활용한다.
	- C언어 핵심: 포인터 + 배열 + 구조체
### LED 디버깅
- 문제가 있을 것이라 추정되는 코드 사이에 LED 점등 코드를 삽입하여 버그를 잡는다.
- 부트코드 디버깅 시 유용하다.
- 개발 도구가 없을 때 사용한다.
	- 개발 도구가 있다면 중단점을 걸거나 trace를 통해 접근하는 것이 훨씬 쉽다.
- 해커들이 printf 디버깅을 좋아하는 이유
	- 어마어마한 이유가 있다.
### 74 시리즈
- 디지털 전자회로에서 일반적으로 사용되는 [[TTL 논리 소자|TTL]](Transistor-Transistor Logic)
	- 논리회로, 카운터, [[Flip-flop]], [[MUX]], 디코더 등을 제공한다.
- LS(Low-power Schottky), HC(High-speed [[NMOS와 CMOS|CMOS]]), HCT(Hich-speed CMOS, TTL-compatible) 등은 전력 소모, 속도, 입출력 특성 등 다른 특징을 갖는다.
- 74LS {논리회로, 카운터...} 를 검색하면 이미 구현된 회로도를 확인할 수 있다.
### 프로그램을 ROM에서 실행하기
- ROM: Read Only Memory
- 리셋 후 프로세서는 0x0
- 메모리의 종류
	- RAM: 변수를 저장
	- FLASH: 프로그램이 들어간다.
![[Pasted image 20250219164536.png]]

- 프로그램은 램에서 실행할 수도 있다.
	- 롬에서 램으로 복사하여 실행할 수도 있다.
	- 상세한 설명은 이후에 프로세서 구조 수업에서 들어간다.
- 양산 시 ROM writer를 사용하는 경우가 더 효율적이다.
### **레지스터 구조**
- 레지스터란
	- 컴퓨터의 프로세서나 I/O 내에서 자료를 보관하는 아주 빠른 기억 장소
- 하드웨어 레지스터
	- GPIO
- 프로세서 레지스터
	- 하드웨어 레지스터와 다르다.
- N번째 비트를 지칭하는 법
	- N번 비트
- 2진수를 외워야 한다.
	- 16진수 <-> 2진수
### 16진수
- 2진수를 사용할 수 없기 때문에 궁여지책으로 16진수를 사용할 수밖에 없는 것이다.
- [ ] 양방향 변환을 자유자재로 2 <-> 16

| 0000 | 00  |
| ---- | --- |
| 0001 | 01  |
| 0010 | 02  |
| 0011 | 03  |
| 0100 | 04  |
| 0101 | 05  |
| 0110 | 06  |
| 0111 | 07  |
| 1000 | 08  |
|      | 09  |
|      | 0A  |
|      | 0B  |
|      | 0C  |
|      | 0D  |
|      | 0E  |
|      | 0F  |
### 자주 사용하는 논리회로
- AND
	- C연산자의 `&`
	- ZERO(MASK `0`)
	- COMPARATOR
		- 임의의 값을 비교하는 비교기
	- 
- OR
	- C연산자의`|`
	- ONE (MASK `1`)
- XOR
	- C연산자`^`
	- TOGGLE
	- SET to ZERO


---
### 생각(파생된 질문/생각)

### 출처
- LIG Nex1 The SSEN Embedded SW School

### 연결 문서 (연결 이유)
