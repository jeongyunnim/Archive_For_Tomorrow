---
날짜: 2024-08-06
넘버: 
태그: 프로그래밍
저자: Eazy Bytes
출처: https://www.udemy.com/course/master-microservices-with-springboot-docker-kubernetes-korean/
aliases:
---
### 날짜:  2024-08-06 15:39

### 태그: #프로그래밍 #자바 #스프링

>[!메모]
>

### 원문
---
# 마이크로서비스의 가시성과 모니터링
- Observability
- Monitoring
## 마이크로서비스에 가시성과 모니터링이 필요한 이유
### 디버깅
- 마이크로서비스에서 이슈가 발생했을 때 어떻게 디버깅 할 것인가?
	- 여러 마이크로서비스들과 컨테이너를 통해 트랜잭션이 이루어질 것이다.
	- 특정 트랜잭션을 어떻게 추적할 것인가?
- 각 서비스들의 로그를 중앙화해야 한다.
- **인덱싱**, **검색**, **필터링**, **그룹화**하여 버그를 찾을 수 있어야 한다.
- 단일 웹 어플리케이션이라면 관련 로그를 찾아서 파악하면 되지만, 마이크로서비스는 각 컨테이너에 로그가 분산되어있다.
	- 심지어는 20개 이상의 컨테이너의 로그를 뒤져봐야할 수도 있다.
### 서비스 호출의 성능 모니터링
- 서비스 호출의 성능을 어떻게 모니터링 할 것인가?
- 특정 서비스 체인의 경로를 추적하고 각 마이크로서비스에서 요청을 수행하는 데 걸린 시간을 확인할 수 있어야 한다.
### [[Metric]]과 상태(Health) 모니터링
- CPU 사용량, JVM Metric과 같은 컨테이너와 마이크로서비스의 메트릭을 쉽게 모니터링할 수 있는 옵션을 찾아야 한다.
- actuator를 통해서 각각을 모니터링 하는 것은 복잡하다.
### 경보 및 알람
- 중앙에서 마이크로서비스의 상태를 모니터링하고 서비스의 비정상적 동작에 대해 경보 및 알람을 생성해야 한다.
	- 몇 개나 될지 모르는 마이크로서비스를 들여다보고 있을 시간이 없다.
- 경보 및 알림을 통해 마이크로서비스의 중단 전에 대처할 수 있다.

## 가시성(Observability)
- 시스템 출력을 이해하여 시스템 내부 상태를 파악할 수 있는 능력이다.
- 마이크로서비스의 경우 Metric, 로그, trace 데이터를 수집하고 분석하여 observability를 확보할 수 있다.
	- 특정 마이크로서비스가 들어오는 요청을 얼마나 잘 처리하고 있는지
	- 얼마나 많은 오류를 일으키고 있는지
### 가시성의 3가지 토대
#### Metric
- 시스템의 상태를 정량적으로 측정하는 것이다.
- CPU 사용량, 메모리 사용량, 응답 시간 등
#### Log
- 시스템 내부에서 발생하는 이벤트의 기록
- 로그 정보를 토대로 오류, 예외 및 예상치 못한 이벤트 등을 추적할 수 있다.
#### Trace
- 마이크로서비스 네트워크 내부의 시스템을 통과하는 경로에 대한 기록
	- 여러 마이크로서비스를 경유하는 요청의 경우 Trace를 통해 경로를 쉽게 파악할 수 있다.
	- 병목현상을 발견하는 데 유용하다.

## 모니터링
- 애플리케이션에 사용할 수 있는 원격 분석 데이터를 확인하고 장애 상태에 대한 경고를 정의하는 것이다.
### 모니터링이 주는 장점
- 모니터링은 가시성을 통해 확보한 정보들을 통해 대시보드를 구축하고 경고 및 알람을 정의할 수 있다.
	- 특정 컨테이너나 마이크로서비스의 CPU의 점유율이 80%이 넘으면 알람이 트리거 되도록 할 수 있다.
- 모니터링은 문제를 식별할 수 있게 한다.
	- 문제가 발생했을 때 인스턴스를 하나 더 추가하여 트래픽을 분산시키도록 할 수 있다.
- 모니터링을 통해 많은 수의 인스턴스를 등록하거나, 문제가 생긴 인스턴스를 종료하여 마이크로서비스를 최적화할 수 있다.
## 가시성과 모니터링의 차이
### 제공되는 정보의 범위
- 모니터링: 대략적인 정보를 제공한다.
	- 마이크로서비스의 상태, CPU 점유율, 사용 중인 스레드 수 등
- 가시성: 세부 정보를 제공한다.
	- NullPointException을 예로 들면, 이는 특정 컨테이너의 로그를 보지 않으면 문제가 어디있는지 확인할 수 없다.
### 목적
- 모니터링: 문제를 식별하고 문제를 해결하는 데 도움을 준다.
- 가시성: 시스템의 내부 상태를 파악하는 데 도움을 준다.
### 접근방식
- 모니터링: Reactive
	- 사후 대응적인 접근 방식
	- 특정 마이크로서비스의 네트워크 문제 또는 성능 문제가 발생했을 때 대응할 수 있다.
	- 이벤트에 대한 알람, 경고 없이는 대응할 수 없다.
- 가시성: Proactive
	- 사전 예방적 접근 방식
	- 특정 마이크로서비스가 NullPointException을 던지고 있는 경우, 향후 업데이트에 수정 사항을 제공하기 위해 문제를 특정하려고 노력한다.
### 정리

| Feature | Monitoring            | Observability                       |
| ------- | --------------------- | ----------------------------------- |
| 목적      | 문제 정의 및 트러블 슈팅        | 시스템 내부 상태 이해                        |
| 데이터     | Metrics, traces, logs | Metrics, traces, logs, data sources |
| 목표      | 문제 정의                 | 시스템 동작 이해                           |
| 접근 방식   | Reactive              | Proactive                           |


> [!info] 요약
> 모니터링: 문제 대응
> 가시성: 실시간 문제 해결

---
### 생각(파생된 질문/생각)

### 출처
- [유데미 - Java, Spring Boot, Spring Cloud, Docker, Kubernetes, Helm, 마이크로서비스 보안](https://www.udemy.com/course/master-microservices-with-springboot-docker-kubernetes-korean/)

### 연결 문서 (연결 이유)
