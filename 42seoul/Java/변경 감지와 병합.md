---
날짜: 2024-06-16
넘버: 
태그: 프로그래밍
저자: 김영한
출처: https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-%ED%99%9C%EC%9A%A9-1/dashboard
aliases:
---
### 날짜:  2024-06-16 19:59

### 태그: #프로그래밍 #자바 #스프링

>[!메모]
>

### 원문
---
# 변경 감지와 병합(merge)
### 준영속 엔티티
- 영속성 컨텍스트가 더이상 관리하지 않는 엔티티
	- JPA가 관리하지 않는다. 이미 저장되어있는 객체에 대한 ID값을 임의로 부여한 객체도 준영속 엔티티로 볼 수 있다.
- 이대로는 변경 감지가 일어나지 않는다.
- 변경감지 또는 병합을 이용하여 변경을 적용시켜야 한다.
### 변경 감지
- DB에서 find 하여 실제 객체를 변경하는 방법
### 병합
- em.merge()를 사용하여 데이터를 덮어씌우도록 하는 방법
- **주의**: 파라미터로 넘어온 객체가 채워지지 않은 경우 null로 덮어씌워질 수 있다.
## 가장 좋은 방법
> [!tip] 
> 엔티티를 변경할 때는 항상 변경 감지를 이용하라.
- 컨트롤러에서 어설프게 엔티티를 생성하면 안된다.
- 트랜잭션이 있는 서비스 계층에 식별자와 변경할 데이터를 명확하게 전달하라.
	- 파라미터가 너무 많아질 경우 DTO를 생성하여 넘기자.
- 트랜잭션이 있는 서비스 계층에서 영속 상태의 엔티티를 조회하고, 엔티티의 데이터를 직접 변경하라.
- 트랜잭션 커밋 시점에 변경 감지가 실행된다.




---
### 생각(파생된 질문/생각)

### 출처
- [실전! 스프링 부트와 JPA 활용1](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-%ED%99%9C%EC%9A%A9-1/dashboard)

### 연결 문서 (연결 이유)
