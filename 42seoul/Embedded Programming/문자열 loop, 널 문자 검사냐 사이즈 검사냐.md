---
날짜: 2025-01-13
넘버: 
태그: 
출처: 
aliases:
---
### 날짜:  2025-01-13 01:20

### 태그:

>[!메모]
>

### 원문
---
# 문자열 loop, 널 문자 검사냐 사이즈 검사냐
### **1. 우선순위를 결정하는 기준**

1. **배열 크기(`size`)를 벗어나지 않는 안전성 확보**
    
    - 포인터 `p`가 유효하다 하더라도, `size`를 초과해서 접근하면 **미정 행동(Undefined Behavior)**이 발생할 수 있습니다. 따라서, 먼저 `size`를 확인하는 것이 안전합니다.
2. **널 종료 문자열 여부**
    
    - 만약 `p`가 널 종료 문자열이라는 보장이 있다면, `*p`를 먼저 확인하여 루프를 종료할 수 있습니다.
    - 하지만 `size`가 제한 값으로 주어졌다면, `size`를 초과하지 않도록 하는 것이 더 중요합니다.
3. **유효성 검사의 명확성**
    
    - 보통, 배열과 같은 고정된 크기와 함께 사용하는 함수에서는 `size`가 가장 우선됩니다. 이로 인해 코드의 의도를 명확히 알 수 있습니다.

---

### **2. 두 가지 방식의 동작 비교**

#### **(1) `size`를 먼저 검사**

cpp

코드 복사

`for (int i = 0; i < size && *p; ++i, ++p) {     // 작업 수행 }`

- **장점:**
    - `size` 초과를 방지하기 때문에 메모리 접근이 안전합니다.
    - 더 일반적인 패턴이며, 안전성 중심의 설계입니다.
- **단점:**
    - `size`를 초과하지 않는 상황에서도, 배열 내에 `\0`이 있으면 루프가 종료됩니다.

#### **(2) `*p`를 먼저 검사**

cpp

코드 복사

`for (; *p && size > 0; --size, ++p) {     // 작업 수행 }`

- **장점:**
    - 널 종료 문자열을 먼저 처리하여 더 빠르게 루프를 종료할 수 있습니다.
    - `p`가 널 종료 문자열이라는 보장이 있을 때 효율적입니다.
- **단점:**
    - `size`를 초과하지 않는 보장이 없으면 메모리 접근 오류가 발생할 수 있습니다.

---

### **3. 선택 기준**

1. **`p`가 반드시 널 종료 문자열이라는 보장이 있을 때:**
    
    - `*p`를 먼저 검사하는 것이 더 적합합니다. 이는 불필요한 `size` 조건 검사를 줄이고, 널 종료를 통해 빠르게 종료할 수 있습니다.
2. **`p`가 널 종료 문자열이 아닐 수도 있고, 크기가 제한되어 있을 때:**
    
    - `size`를 먼저 검사해야 안전합니다. 이를 통해 배열의 경계를 벗어나는 오류를 방지할 수 있습니다.

---

### **4. 권장 코드 구조**

가장 안전한 구조는 **`size`를 먼저 검사**한 다음, `*p`를 확인하는 방식입니다. 이렇게 하면 메모리 안전성을 보장하면서도 널 종료 문자열도 처리할 수 있습니다.

cpp

코드 복사

`void my_toupper(char* p, int size) {     if (!p || size <= 0) return; // 기본 유효성 검사      for (int i = 0; i < size && *p; ++i, ++p) {         if ('a' <= *p && *p <= 'z') {             *p = *p - 'a' + 'A'; // 대문자로 변환         }     } }`

---

### **결론**

- **안전성 중심의 설계:** `size`를 먼저 검사하는 것이 일반적으로 더 안전하고 추천됩니다.
- **성능 중심의 설계:** `p`가 널 종료 문자열이라는 보장이 있다면 `*p`를 먼저 검사해도 괜찮습니다.
- 항상 입력 데이터(`p`와 `size`)의 조건을 명확히 정의하고, 조건에 맞는 검사 순서를 선택하는 것이 중요합니다.
- 
---
### 생각(파생된 질문/생각)

### 출처

### 연결 문서 (연결 이유)
